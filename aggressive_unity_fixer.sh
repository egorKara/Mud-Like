#!/bin/bash

# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º Unity Editor

echo "üö® –ê–ì–†–ï–°–°–ò–í–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï UNITY EDITOR"
echo "======================================="

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo ""
echo "üîç –ê–ì–†–ï–°–°–ò–í–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê"
echo "=========================="

# 1. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Unity
echo "üßπ –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Unity..."
rm -rf Library Temp Logs UserSettings 2>/dev/null
echo -e "  ${GREEN}‚úÖ –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞${NC}"

# 2. –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤ Asset Import Workers
echo "üßπ –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–æ–≥–æ–≤ Asset Import Workers..."
find . -name "AssetImportWorker*.log" -delete 2>/dev/null
find . -name "*.log" -path "*/Logs/*" -delete 2>/dev/null
echo -e "  ${GREEN}‚úÖ –í—Å–µ –ª–æ–≥–∏ —É–¥–∞–ª–µ–Ω—ã${NC}"

# 3. –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ Unity
echo "üîß –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ Unity..."
rm -rf ProjectSettings/EditorBuildSettings.asset 2>/dev/null
rm -rf ProjectSettings/ProjectVersion.txt 2>/dev/null
echo -e "  ${GREEN}‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã${NC}"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö .meta —Ñ–∞–π–ª–æ–≤
echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö .meta —Ñ–∞–π–ª–æ–≤..."
find Assets -name "*.meta" -exec rm -f {} \; 2>/dev/null
echo -e "  ${GREEN}‚úÖ –í—Å–µ .meta —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã (–±—É–¥—É—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω—ã Unity)${NC}"

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ Assembly Definition —Ñ–∞–π–ª–æ–≤
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Assembly Definition —Ñ–∞–π–ª–æ–≤..."
find Assets -name "*.asmdef" -exec echo "–ü—Ä–æ–≤–µ—Ä–∫–∞: {}" \; 2>/dev/null
echo -e "  ${GREEN}‚úÖ Assembly Definition —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã${NC}"

# 6. –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
echo "üîß –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞..."
mkdir -p Library/ScriptAssemblies 2>/dev/null
mkdir -p Temp 2>/dev/null
mkdir -p Logs 2>/dev/null
echo -e "  ${GREEN}‚úÖ –ß–∏—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ${NC}"

echo ""
echo "üõ†Ô∏è  –ê–ì–†–ï–°–°–ò–í–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø"
echo "============================"

# 7. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è
echo "‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è..."
find Assets -name "*.cs" -exec touch {} \; 2>/dev/null
echo -e "  ${GREEN}‚úÖ –í—Å–µ C# —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã${NC}"

# 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
echo "üîê –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞..."
find . -type f -name "*.cs" -exec chmod 644 {} \; 2>/dev/null
find . -type d -exec chmod 755 {} \; 2>/dev/null
chmod +x *.sh 2>/dev/null
echo -e "  ${GREEN}‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã${NC}"

# 9. –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
echo "üßπ –£–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
find . -name "*.tmp" -delete 2>/dev/null
find . -name "*.temp" -delete 2>/dev/null
find . -name "*.swp" -delete 2>/dev/null
find . -name "*~" -delete 2>/dev/null
echo -e "  ${GREEN}‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã${NC}"

# 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
damaged_files=$(find Assets -name "*.cs" -size 0 2>/dev/null | wc -l)
if [ $damaged_files -gt 0 ]; then
    echo -e "  ${YELLOW}‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω–æ $damaged_files –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤${NC}"
    find Assets -name "*.cs" -size 0 -delete 2>/dev/null
    echo -e "  ${GREEN}‚úÖ –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã${NC}"
else
    echo -e "  ${GREEN}‚úÖ –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ${NC}"
fi

echo ""
echo "üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ì–†–ï–°–°–ò–í–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø"
echo "======================================"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
total_files=$(find Assets -name "*.cs" | wc -l)
total_lines=$(find Assets -name "*.cs" -exec wc -l {} + | tail -1 | awk '{print $1}' 2>/dev/null || echo "0")

echo -e "–§–∞–π–ª–æ–≤ C#: ${BLUE}$total_files${NC}"
echo -e "–°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ${BLUE}$total_lines${NC}"

echo ""
echo "üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û–°–õ–ï –ê–ì–†–ï–°–°–ò–í–ù–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø"
echo "=============================================="

echo -e "${YELLOW}‚ö†Ô∏è  –í–ê–ñ–ù–û:${NC}"
echo -e "  ‚Ä¢ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Unity Editor"
echo -e "  ‚Ä¢ –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞"
echo -e "  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ Asset Import Workers —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
echo -e "  ‚Ä¢ –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ .meta —Ñ–∞–π–ª—ã –∏–∑ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è"

echo -e "${BLUE}üí° –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:${NC}"
echo -e "  ‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ ./proactive_unity_maintenance.sh"
echo -e "  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–ª—è .meta —Ñ–∞–π–ª–æ–≤"
echo -e "  ‚Ä¢ –ò–∑–±–µ–≥–∞–π—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ Unity"
echo -e "  ‚Ä¢ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Unity –∏ –ø–∞–∫–µ—Ç—ã"

echo ""
echo "‚úÖ –ê–ì–†–ï–°–°–ò–í–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û"
echo "===================================="
echo -e "${RED}üö® –í–ù–ò–ú–ê–ù–ò–ï: Unity Editor –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å!${NC}"
